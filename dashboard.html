<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="card">
<h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h2>
<p id="welcome"></p>

<form onsubmit="addItem(event)">
<input type="text" id="itemName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£" required>
<input type="number" id="amount" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" required>
<select id="type">
<option value="‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</option>
<option value="‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
</select>
<button type="submit">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
</form>

<table>
<thead>
<tr>
<th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
<th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
<th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
</tr>
</thead>
<tbody id="dataTable"></tbody>
</table>

<hr>

<h3>‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</h3>
<p>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°: <span id="totalIncome">0</span> ‡∏ö‡∏≤‡∏ó</p>
<p>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°: <span id="totalExpense">0</span> ‡∏ö‡∏≤‡∏ó</p>
<p>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: <span id="balance">0</span> ‡∏ö‡∏≤‡∏ó</p>

<br>
<button onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
</div>

<script>

let currentUser=localStorage.getItem("currentUser");

if(!currentUser){
window.location.href="index.html";
}

document.getElementById("welcome").innerText="‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ "+currentUser+" üíñ";

function loadData(){
let userData=JSON.parse(localStorage.getItem(currentUser));
let data=userData.data;
let table=document.getElementById("dataTable");
table.innerHTML="";

data.forEach(item=>{
table.innerHTML+=`
<tr>
<td>${item.name}</td>
<td>${item.amount}</td>
<td>${item.type}</td>
</tr>`;
});

calculateTotals(data);
}

function addItem(e){
e.preventDefault();

let name=document.getElementById("itemName").value;
let amount=document.getElementById("amount").value;
let type=document.getElementById("type").value;

let userData=JSON.parse(localStorage.getItem(currentUser));
userData.data.push({name,amount,type});
localStorage.setItem(currentUser,JSON.stringify(userData));

loadData();
e.target.reset();
}

function calculateTotals(data){
let income=0;
let expense=0;

data.forEach(item=>{
let amt=Number(item.amount);
if(item.type==="‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö") income+=amt;
else expense+=amt;
});

document.getElementById("totalIncome").innerText=income;
document.getElementById("totalExpense").innerText=expense;
document.getElementById("balance").innerText=income-expense;
}

function logout(){
localStorage.removeItem("currentUser");
window.location.href="index.html";
}

loadData();
</script>

</body>
</html>
